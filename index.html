<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>বাংলা স্টক ফটো - বিনামূল্যে ছবি ডাউনলোড করুন</title>
    <meta name="description" content="উচ্চ মানের এবং বিনামূল্যে স্টক ছবি ডাউনলোড করুন। আমাদের বিশাল সংগ্রহ থেকে আপনার পছন্দের ছবি খুঁজুন।">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <header>
        <div class="logo">ছবিঘর</div>
        <nav>
            <a href="/">হোম</a>
            <a href="/upload.html">আপলোড</a>
            <div id="auth-container">
                <!-- লগইন/লগআউট বাটন এখানে JS দিয়ে যোগ হবে -->
            </div>
        </nav>
    </header>

    <main>
        <h1>সাম্প্রতিক ছবি</h1>
        <div id="image-grid" class="image-grid">
            <!-- ছবিগুলো JS দিয়ে এখানে লোড হবে -->
        </div>
    </main>

    <script type="module">
        import { auth } from '/static/js/firebase-config.js';
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

        const authContainer = document.getElementById('auth-container');
        const imageGrid = document.getElementById('image-grid');

        // ইউজার লগইন স্টেট চেক
        onAuthStateChanged(auth, user => {
            if (user) {
                authContainer.innerHTML = `<a href="/profile.html">প্রোফাইল</a> <button id="logout-btn">লগআউট</button>`;
                document.getElementById('logout-btn').addEventListener('click', () => signOut(auth));
            } else {
                authContainer.innerHTML = `<button onclick="location.href='/auth.html'">লগইন</button>`;
            }
        });

        // API থেকে ছবি লোড করা
        async function loadImages() {
            const response = await fetch('/api/images');
            const images = await response.json();
            imageGrid.innerHTML = '';
            images.forEach(img => {
                const card = `
                    <div class="image-card">
                        <a href="/photo/${img.slug}">
                            <img src="${img.thumbUrl}" alt="${img.title}" loading="lazy">
                            <p class="image-card-title">${img.title}</p>
                        </a>
                    </div>
                `;
                imageGrid.innerHTML += card;
            });
        }

        loadImages();
    </script>
</body>
</html>
